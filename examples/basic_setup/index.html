<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Chroma Example</title>
    <script src="../../ChromaSDKImpl.js"></script>
    <script>
        window.onload = () => {
            // Initialise global Chroma SDK object
            chromaSDK.init();

            // Wait for Chroma SDK to initialize
            new Promise((resolve) => {
                const poll = () => {
                    if (chromaSDK.initialized)
                        resolve();
                    else
                        setTimeout(poll, 100);
                };
                setTimeout(poll, 100);
            }).then(() => {
                // Load animations for each device
                for (let device of [
                    { suffix: "ChromaLink", id: EChromaSDKDeviceEnum.DE_ChromaLink },
                    { suffix: "Headset", id: EChromaSDKDeviceEnum.DE_Headset },
                    { suffix: "Keyboard", id: EChromaSDKDeviceEnum.DE_Keyboard },
                    { suffix: "Keypad", id: EChromaSDKDeviceEnum.DE_Keypad },
                    { suffix: "Mouse", id: EChromaSDKDeviceEnum.DE_Mouse },
                    { suffix: "Mousepad", id: EChromaSDKDeviceEnum.DE_Mousepad },
                ]) {
                    const name = `../animations/RainbowWipe_${device.suffix}.chroma`;

                    console.log(`Loading ${name}...`);

                    ChromaAnimation.closeAnimation(name); // close animation if already open
                    ChromaAnimation.openAnimation(name, (anim) => {
                        if (!anim)
                            return;

                        // Set custom color flag
                        ChromaAnimation.setChromaCustomColorAllFrames(anim.Name);

                        // Play animation
                        ChromaAnimation.playAnimation(anim.Name, true, () => { });

                        console.log(`Playing ${anim.Name}...`);
                    }, false);
                }
            });
        }

        window.onbeforeunload = () => {
            // Uninitialise global Chroma SDK object
            chromaSDK.uninit();
        }
    </script>
</head>

<body>
    Basic Setup Example
</body>

</html>